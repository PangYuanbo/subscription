# Subscription Tracker Browser Extension

智能订阅管理浏览器插件，自动检测订阅服务页面并提取信息，快速创建订阅记录。

## 功能特性

### 🎯 智能检测
- 自动识别70+热门订阅服务网站
- 检测订阅、计费、结账相关页面
- 智能分析页面内容和价格信息
- **实时监听支付行为和订阅操作**

### 💳 支付行为检测
- **支付链接监听**：检测点击支付、结账、购买链接
- **支付表单监听**：监听支付表单提交行为
- **支付页面识别**：自动识别 Stripe、PayPal、支付宝等支付页面
- **支付按钮监听**：检测支付按钮点击事件
- **自动弹窗提醒**：检测到支付行为时自动弹出订阅记录表单

### 🔔 订阅行为监听
- **订阅按钮监听**：检测"订阅"、"升级"按钮点击
- **套餐选择监听**：监听用户选择不同订阅套餐
- **计费周期监听**：检测月费/年费切换操作
- **实时信息提取**：实时提取价格、套餐名称等信息

### 📊 信息提取
- 自动提取服务名称
- 识别价格和计费周期（月费/年费）
- 检测套餐名称和功能特性
- 智能判断计费选项
- **识别支付方式**：检测信用卡、PayPal、支付宝、微信支付等

### ⚡ 快速录入
- 页面内弹窗提示
- **支付行为触发**：检测到支付时自动弹出
- 预填检测到的信息
- **试用期支持**：自动检测和管理试用期信息
- **🤖 NLP智能解析**：支持自然语言描述订阅信息
- 用户只需补充缺失数据
- 一键添加到订阅管理系统

### 🔐 Auth0认证集成
- **安全认证**：支持Auth0单点登录
- **用户识别**：自动关联用户账户
- **权限管理**：安全访问用户订阅数据
- **令牌管理**：自动处理访问令牌

### 🔧 支持的网站
- **娱乐**: Netflix, Spotify, YouTube Premium, Disney+, Hulu, Apple TV+, HBO Max, Twitch
- **开发工具**: GitHub, GitLab, JetBrains, VS Code, Figma, Sketch, Adobe Creative Cloud
- **云服务**: AWS, Google Cloud, Azure, DigitalOcean, Heroku, Vercel, Netlify
- **生产力**: Slack, Discord, Zoom, Notion, Microsoft 365, Google Workspace, Dropbox
- **教育**: Coursera, Udemy, Skillshare, Duolingo
- **健康**: Headspace, Apple Fitness+, Peloton
- **其他**: 通用检测任何包含订阅关键词的页面

## 安装步骤

### 1. 准备插件文件
确保以下文件在 `browser-extension` 目录中：
- `manifest.json`
- `background.js`
- `content.js`
- `content.css`
- `popup.html`
- `popup.js`
- `icons/` (图标文件夹)

### 2. 创建图标文件
在 `icons/` 目录中放置以下图标文件：
- `icon16.png` (16x16px)
- `icon48.png` (48x48px)
- `icon128.png` (128x128px)

### 3. 安装到Chrome/Edge
1. 打开浏览器扩展管理页面：
   - Chrome: `chrome://extensions/`
   - Edge: `edge://extensions/`

2. 开启"开发者模式"

3. 点击"加载已解压的扩展程序"

4. 选择 `browser-extension` 文件夹

### 4. 配置主应用
确保订阅管理主应用运行在以下端口之一：
- **生产环境**: `https://subscription-tracker-backend.modal.run`
- **开发环境**: `http://localhost:8000` (后端API)
- **前端开发**: `http://localhost:5173` (前端开发服务器)

## 使用方法

### 🚀 智能检测模式
1. **订阅页面检测**：访问任何订阅服务网站（如 Netflix、Spotify 等）
2. **支付行为监听**：点击"订阅"、"升级"、"购买"按钮时自动检测
3. **支付流程拦截**：进入支付页面时自动识别并弹出记录表单
4. **实时提示**：插件会根据用户行为智能提示

### 💳 支付检测触发场景
- **订阅按钮点击**：点击订阅、升级按钮时
- **支付链接跳转**：点击支付链接跳转时
- **支付表单提交**：提交支付表单时
- **支付页面访问**：访问 Stripe、PayPal 等支付页面时
- **购买操作**：任何涉及付费的操作

### 🔧 手动添加
1. 点击浏览器工具栏中的插件图标
2. 在弹窗中手动输入订阅信息
3. 点击"添加订阅"

### 📝 信息补充
当插件检测到订阅服务时：
1. **自动填充**：已识别的信息（服务名、价格、计费周期等）
2. **用户补充**：
   - 账户邮箱
   - 确认计费周期
   - 调整价格（如需要）
   - 设置付款日期
   - **试用期设置**：是否为试用订阅，试用时长等
3. **🤖 智能解析模式**：
   - 点击"Smart Parse"按钮
   - 输入自然语言描述，如："我刚注册了Netflix高级版，月费15.99美元，账户是john@email.com，下次付款是1月15日"
   - AI自动解析并创建订阅记录
4. **一键提交**：确认信息后一键添加到订阅管理系统

## 技术实现

### 检测机制
- URL模式匹配
- 页面内容关键词分析
- 价格模式识别
- 表单元素检测

### 信息提取
- DOM选择器匹配
- 正则表达式价格提取
- 上下文语义分析
- 计费周期智能判断

### 数据流程
1. 内容脚本检测页面
2. 背景脚本处理数据
3. 弹窗展示和收集信息
4. 提交到主应用API

## 开发调试

### 查看日志
打开浏览器开发者工具：
- Console: 查看内容脚本日志
- Background Page: 查看背景脚本日志
- Popup: 查看弹窗脚本日志

### 测试页面
推荐测试的订阅服务页面：
- https://www.netflix.com/signup
- https://www.spotify.com/premium/
- https://github.com/pricing
- https://www.adobe.com/products/
- https://aws.amazon.com/pricing/

### 权限说明
- `activeTab`: 访问当前标签页内容
- `storage`: 存储检测到的订阅数据和认证信息
- `scripting`: 注入内容脚本
- `notifications`: 显示检测通知和操作提醒

## 常见问题

### Q: 插件没有检测到订阅页面？
A: 检查以下几点：
- 确保页面包含订阅相关关键词
- 检查URL是否匹配支持的模式
- 查看控制台是否有错误信息

### Q: 无法提交订阅数据？
A: 确认以下设置：
- 主应用是否运行在正确端口
- **Auth0认证状态**：确保已登录主应用
- 检查网络连接
- 查看浏览器是否阻止跨域请求

### Q: NLP智能解析失败？
A: 检查以下问题：
- 描述是否包含关键信息（服务名、价格、账户、付款日期）
- 网络连接是否正常
- 后端API是否正常运行

### Q: 价格信息提取不准确？
A: 插件会尽力提取价格信息，但可能需要用户手动确认和调整。

## 更新日志

### v2.0.0 (2025-08-23)
- **🔐 Auth0认证集成**：支持安全的用户认证和数据关联
- **🆕 试用期管理**：自动检测和管理试用期信息
- **🤖 NLP智能解析**：支持自然语言描述创建订阅记录
- **🔗 多端点支持**：支持生产环境和开发环境API
- **📊 增强数据结构**：支持更丰富的订阅信息
- **🔔 改进通知系统**：更友好的操作反馈

### v1.0.0
- 初始版本发布
- 支持70+订阅服务网站
- 智能价格和计费周期检测
- 与主应用无缝集成

## 技术支持

如果遇到问题或有改进建议，请：
1. 检查浏览器控制台错误信息
2. 确认主应用运行状态
3. 提供具体的网站URL和错误描述

---

插件让订阅管理变得更智能、更便捷！🎉